Milestone 1 done. Fix some issues. Polishing

Milestone 2 done. Some fixes and polishing

Merge commit fixing conflicts for feature_milestone2 branch